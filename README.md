# ПБЗ Лабораторная работа № 2

## Холупко А.А., гр. 821701
## Вариант 1
### Условие:
Предприятие – высшее учебное заведение. В структуре есть вычислительный центр, в составе которого, в свою очередь, есть ремонтная мастерская. Словесное описание предметной области: Предприятие, в состав которого входит ряд подразделений, имеет ремонтную мастерскую, в которой производится различного вида ремонт средств вычислительной и оргтехники. Необходимо вести учет, сданной в ремонт техники. Для каждой единицы техники необходимо хранить её инвентарный номер, название устройства, его модель, год выпуска, какому подразделению устройство принадлежит на текущую дату, т.е. необходимо хранить историю перемещения техники между подразделениями организации. Перемещение единицы техники осуществляется на основе документа, в котором указано с какой даты данная единица перемещается в указанное подразделение. Эта дата одновременно является датой окончания нахождения единицы техники в предыдущем подразделении. Необходимо также хранить дату сдачи единицы техники в ремонт, вид ремонта, срок ремонта, ФИО, номер сотрудника, сдавшего технику в ремонт, ФИО, номер сотрудника, который принял технику в ремонт, ФИО, номер, должность сотрудника, выполняющего ремонт, перечень необходимых для ремонта запасных частей, их стоимость на текущую дату. Стоимость запасных частей определяется из документа – накладной, по которой они получены, в ней и указана дата получения, стоимость. О каждом сотруднике необходимо хранить информацию о всех перемещениях за время работы на данном предприятии: дата начала работы, дата окончания, подразделение, должность.

### Необходимо реализовать выполнения следующих функций:
  1. Добавление/редактирование информации о средствах вычислительной и оргтехники в подразделении.
  2. Списание средств вычислительной и оргтехники подразделения.
  3. Ведение учета перемещений, сданной в ремонт техники.
  4. Добавление/редактирование/удаление сотрудников подразделений.
  5. Обеспечить расчет количества техники определенного наименования по выбранному подразделению по годам (за три года).
  6. Вывести для просмотра список сотрудников (ФИО, год рождения) по выбранному подразделению.
  7. Вывести для просмотра списки сотрудников (ФИО, год рождения) по выбранному возрасту и полу.
  8. Вывести для просмотра название подразделения, у которого была наибольшее количество техники, переданной в ремонт.
  
### Релизация:
  Данное задание реализовано в виде API сервера на языке GO, СУБД - PostgreSQL. Операционная система - Linux Xubuntu 18.04
  
### Getting started:
  1. git clone репозитория: `git clone https://github.com/Alex27Khalupka/PBZ_Lab_2_Enterprise`.
  2. Создайте базу данных.
  3. Сделайте импорт файла postgres.bak в вашу базу данных: `psql dbname < postgres.bak`
  4. Задайте переменную среды $POSTGRES_URI(URI вашей базы данных): `export POSTGRES_URI=your_database_uri`, к примеру: `postgres://postgres:postgres@localhost:5432/enterprise`.
  5. Соберите проект, команда `make` в директории проекта.
  6. Запустите API server: `./apiserver`
  
### Работа с API сервером:
  Тело всех запросов должно быть в формате JSON.
  Для удобства можно использовать программу Postman.
  1. **Добавление информации о средствах вычислительной и оргтехники в подразделении:**
  - Отправте POST запрос на URL `localhost:8080/inventory/{division_id}`, где `{division_id}` - номер подразделения. Пример тела запроса:
    - `{"inventory_number": "I0", "inventory_name": "name", "inventory_model": "model", "year_of_issue": "2000-01-01T00:00:00Z"}`
  2. **Редактирование информации о средствах вычислительной и оргтехники в подразделении:**
  - Отправте PUT запрос на URL `localhost:8080/inventory/{inventory_id}`, где `{inventory_id}` - номер подразделения. Пример тела запроса:
    - `{"inventory_number": "I0", "inventory_name": "name", "inventory_model": "model", "year_of_issue": "2000-01-01T00:00:00Z"}`, некоторые поля могут отсуствовать (они останутся без изиенений). Номера техники редактировать нельзя.
  3. **Списание средств вычислительной и оргтехники подразделения:**
  - Отправте DELETE запрос на URL `localhost:8080/inventory/{inventory_id}`, где `{inventory_id}` - номер техники, которую необходимо удалить.
  4. **Список перемещений, сданной в ремонт техники.**
  - Отправте GET запрос на URL `localhost:8080/movement_of_inventory`.
  5. **Добавление сотрудников подразделений.**
  -  Отправте POST запрос на URL `localhost:8080/employee/{division_id}`, где `{division_id}` - номер подразделения в которое добавляется сотрудник. Пример тела запроса:
    - `{"employee_number": "E0", "first_name": "Ryan", "last_name": "Cooper", "second_name": "James", "position": "3","age": 30, "sex": "Male"}`. 
  6. **Редактирование сотрудников подразделений.**
  - Отправте PUT запрос на URL `localhost:8080/inventory/{employee_id}`, где `{emplyee_id}` - номер редактируемой техник. Пример тела запроса:
    - `{"employee_number": "E0", "first_name": "Ryan", "last_name": "Cooper", "second_name": "James", "position": "3","age": 30, "sex": "Male"}`некоторые поля могут отсуствовать (они останутся без изиенений). Номера сотрудников редактировать нельзя.
  7. **Удаление сотрудников подразделений:**
  - Отправьте DELETE запрос на URL `localhost:8080/inventory/{employee_id}`, где `{employee_id}` - номер сотрудника, которого необходимо удалить.
  8. **Вывести для просмотра список сотрудников (ФИО, год рождения) по выбранному подразделению:**
  - Отправьте GET запрос на URL `localhost:8080/employees/{divison_id}`, где `{division_id}` - номер подразделения.
  9. **Вывести для просмотра списки сотрудников (ФИО, год рождения) по выбранному возрасту и полу.**
  - Отправьте GET запрос на URL `localhost:8080/employees?{age}&{sex}`, где `{age}` - возраст сотрудника, `{sex}` - пол сотрудника.
  10. **Вывести для просмотра название подразделения, у которого была наибольшее количество техники, переданной в ремонт.**
  - Отправьте GET запрос на URL `localhost:8080//divisions/max_repairs_amount`.
  11. **Обеспечить расчет количества техники определенного наименования по выбранному подразделению по годам (за три года).**
  - Отправьте GET запрос на URL `localhost:8080/inventory?{years}&{division_id}&{name}`, где `{years}` - за сколько лет, `{division_id}` - номер подразделения, `{name}` - название техники.
  12. **Добавить обходной лист**
  - Отправте POST запрос на URL `localhost:8080/watbills`, Пример тела запроса:
    - `{"waybill_number": "W0", "receiving_date": "2020-03-02T00:00:00Z", "price": "500", "detai_name": "awesome name"}`
  13. **Записать информацию об отправленной в ремонт технике**
  -Отправте POST запрос на URL `localhost:8080/repairs`, Пример тела запроса:
    - `"repair_id": "R0", "inventory_number": "I0", "service_start_date": "2020-08-26T00:00:00Z", "repair_type": "major fix", "days_to_repair": 40, "employee_number": "E0", "waybill_number": "W0"` 
  14. **Получить список перемещений сотрудников по подразделениям:**
    - Отправьте GET запрос на URL `localhost:8080/movement_of_employees`
  15. **Получить список перемещений техники по подразделениям:**
    - Отправьте GET запрос на URL `localhost:8080/movement_of_inventory`
  16. **Получить список обходных листов:**
  - Отправьте GET запрос на URL `localhost:8080/waybills`
  17. **Получить список техники:**
  - Отправьте GET запрос на URL `localhost:8080/inventory`
  18. **Получить список сотрудников:**
  - Отправьте GET запрос на URL `localhost:8080/employees`
  
  
  
  
  
